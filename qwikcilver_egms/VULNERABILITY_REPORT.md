# Security Vulnerability Assessment Report
## QwikCilver Electronic Gift Card Management System

**Report Date:** 2026-02-07  
**Assessed By:** Security Review Team  
**Application:** QwikCilver eGMS Login Portal  
**URL:** https://qc3.qwikcilver.com/QwikCilver/eGMS/WebUI/Login.aspx

---

## Executive Summary

This report documents security vulnerabilities identified in the client-side JavaScript code of the QwikCilver Electronic Gift Card Management System. The assessment reveals **4 Critical**, **5 High**, and **3 Medium** severity issues primarily related to cryptographic implementations and information disclosure.

| Severity | Count |
|----------|-------|
| üî¥ Critical | 4 |
| üü† High | 5 |
| üü° Medium | 3 |
| **Total** | **12** |

---

## Vulnerabilities Identified

### üî¥ CRITICAL-001: Hardcoded Encryption Key in Client-Side Code

**File:** `QwikCilver Electronic Gift Card Management System.html` (Lines 254-260)  
**CVSS Score:** 9.8 (Critical)

**Description:**  
The AES encryption key components are hardcoded directly in the HTML/JavaScript source code, which is visible to anyone viewing the page source.

**Affected Code:**
```javascript
var iv = CryptoJS.enc.Hex.parse('37462a456f392725376d752a2650573e');
var Pass = CryptoJS.enc.Utf8.parse('7d5d61656b');
var Salt = CryptoJS.enc.Utf8.parse("424d3b6b79252427633878407d");
```

**Impact:**  
- Attackers can decrypt any data encrypted with these keys
- Complete compromise of encrypted data confidentiality
- Attackers can forge encrypted data

**Recommendation:**  
- Never hardcode cryptographic keys in client-side code
- Use server-side encryption for sensitive operations
- If client-side encryption is required, derive keys from user-specific secrets

---

### üî¥ CRITICAL-002: Hardcoded Initialization Vector (IV)

**File:** `QwikCilver Electronic Gift Card Management System.html` (Line 254)  
**CVSS Score:** 9.1 (Critical)

**Description:**  
The AES Initialization Vector (IV) is hardcoded and static. In CBC mode, the IV must be unique and unpredictable for each encryption operation.

**Affected Code:**
```javascript
var iv = CryptoJS.enc.Hex.parse('37462a456f392725376d752a2650573e');
```

**Impact:**  
- Same plaintext always produces the same ciphertext (deterministic encryption)
- Enables pattern analysis attacks
- Violates fundamental cryptographic security requirements

**Recommendation:**  
- Generate a new random IV for each encryption operation
- Transmit the IV along with the ciphertext (IVs don't need to be secret, just unique)

---

### üî¥ CRITICAL-003: Weak PBKDF2 Configuration in Library Default

**File:** `pbkdf2.js` (Line 54)  
**CVSS Score:** 8.1 (High/Critical)

**Description:**  
The PBKDF2 library defaults to only **1 iteration** for key derivation, which provides virtually no protection against brute-force attacks.

**Affected Code:**
```javascript
cfg: e.extend({ keySize: 4, hasher: j.SHA1, iterations: 1 })
```

**Note:** The login page uses 1000 iterations (Line 263 in HTML), which is better but still below modern standards.

**Impact:**  
- Passwords can be brute-forced extremely quickly
- May affect other parts of the application using default settings

**Recommendation:**  
- Use minimum 100,000 iterations for PBKDF2 (OWASP recommendation)
- Consider migrating to Argon2 or bcrypt for password hashing
- Update the library default to a secure value

---

### üî¥ CRITICAL-004: Deprecated Cryptographic Algorithms

**Files:** `aes.js`, `pbkdf2.js`  
**CVSS Score:** 7.5 (High)

**Description:**  
The cryptographic libraries use deprecated hash algorithms:
- **MD5** - Used in EvpKDF for key derivation (aes.js)
- **SHA-1** - Default hash for PBKDF2 (pbkdf2.js)

Both MD5 and SHA-1 have known collision vulnerabilities.

**Impact:**  
- Potential vulnerabilities in key derivation
- Non-compliance with security standards (PCI-DSS, SOC2)
- May fail security audits

**Recommendation:**  
- Upgrade to SHA-256 or SHA-512
- Use modern cryptographic library (e.g., Web Crypto API, libsodium)

---

### üü† HIGH-001: Sensitive Information in ViewState

**File:** `QwikCilver Electronic Gift Card Management System.html` (Line 103)  
**CVSS Score:** 6.5 (Medium/High)

**Description:**  
ASP.NET ViewState is present and contains base64-encoded data. While encrypted, the `__VIEWSTATEENCRYPTED` field is empty, suggesting possible configuration issues.

**Affected Code:**
```html
<input type="hidden" name="__VIEWSTATE" value="OMXPM4LmRItg1tkWeyyyVXf...">
<input type="hidden" name="__VIEWSTATEENCRYPTED" value="">
```

**Impact:**  
- ViewState tampering if MAC validation is disabled
- Potential information disclosure

**Recommendation:**  
- Ensure ViewState MAC validation is enabled
- Verify `<pages enableViewStateMac="true">` in web.config
- Consider using ViewState encryption

---

### üü† HIGH-002: Client-Side Session Token Exposure

**File:** `SignalRNotification.js` (Lines 146-150)  
**CVSS Score:** 6.8 (Medium/High)

**Description:**  
User session identifiers are transformed using a predictable XOR operation that provides no real security.

**Affected Code:**
```javascript
function convertTorefUid(UserId) {
    const userId = BigInt(UserId);
    const refUid = userId ^ BigInt("9223372036854775807"); // XOR with long.MaxValue
    return refUid.toString();
}
```

**Impact:**  
- Session tokens can be easily reversed to obtain user IDs
- Enables session enumeration attacks
- False sense of security through obscurity

**Recommendation:**  
- Use cryptographically secure random session tokens
- Never derive session identifiers from user IDs
- Implement proper session management on server-side

---

### üü† HIGH-003: Exposed API Endpoints

**File:** `QwikCilver Electronic Gift Card Management System.html` (Line 532)  
**CVSS Score:** 5.3 (Medium)

**Description:**  
Production API endpoints and internal paths are exposed in client-side code.

**Affected Code:**
```javascript
var signalRHubURI = 'https://qc3.qwikcilver.com/QwikCilver/QwikID' + '/notificationHub';
var postLogOutRedirectURI = '..' + '/QwikCilver/eGMS/WebUI/LogOut.aspx';
```

**Impact:**  
- Reveals internal application structure
- Aids reconnaissance for targeted attacks
- Exposes backend service URLs

**Recommendation:**  
- Use relative paths where possible
- Implement server-side routing
- Review exposed endpoints for security

---

### üü† HIGH-004: Outdated JavaScript Libraries

**Files:** `aes.js`, `pbkdf2.js`  
**CVSS Score:** 6.1 (Medium)

**Description:**  
CryptoJS v3.1.2 (released in 2013) is being used. This version is over 10 years old and may contain unpatched vulnerabilities.

**Library Header:**
```javascript
/*
CryptoJS v3.1.2
code.google.com/p/crypto-js
(c) 2009-2013 by Jeff Mott. All rights reserved.
*/
```

**Impact:**  
- Potential unpatched security vulnerabilities
- No longer maintained
- May have compatibility issues

**Recommendation:**  
- Upgrade to crypto-js v4.x or newer
- Consider using native Web Crypto API
- Implement a library update policy

---

### üü† HIGH-005: Client ID and Application Secrets Exposed

**File:** `QwikCilver Electronic Gift Card Management System.html` (Lines 533-534)  
**CVSS Score:** 5.3 (Medium)

**Description:**  
Application client identifiers and SSO configuration are exposed in client-side code.

**Affected Code:**
```javascript
var clientId = 'QwikPOS';
var isSSOEnabled = 'true';
```

**Impact:**  
- Reveals SSO implementation details
- May enable SSO bypass attempts
- Exposes application architecture

**Recommendation:**  
- Minimize client-side configuration exposure
- Use server-side session management
- Implement proper access controls

---

### üü° MEDIUM-001: Browser Security Features Attempted Bypass

**File:** `QwikCilver Electronic Gift Card Management System.html` (Lines 39-76, 97)  
**CVSS Score:** 3.7 (Low/Medium)

**Description:**  
The application attempts to disable browser features like back button, refresh (F5), and right-click context menu. These can be bypassed and may indicate security-through-obscurity mindset.

**Affected Code:**
```javascript
oncontextmenu="return false;"
// Blocks F5 refresh
if (evt.keyCode == 116) { evt.keyCode = 8; }
// Blocks backspace navigation
window.history.forward();
```

**Impact:**  
- Does not provide real security
- May frustrate legitimate users
- Can be easily bypassed by attackers

**Recommendation:**  
- Remove these client-side restrictions
- Implement proper server-side security controls
- Focus on secure session management instead

---

### üü° MEDIUM-002: LocalStorage Used for Session Data

**File:** `QwikCilver Electronic Gift Card Management System.html` (Lines 215-240)  
**CVSS Score:** 4.3 (Medium)

**Description:**  
Session-related data is stored in browser localStorage, which persists after the browser is closed and is accessible to any JavaScript on the same origin.

**Affected Code:**
```javascript
var usname = window.location.host.toString() + "eGMS";
localStorage.setItem(usname, mypageid);
```

**Impact:**  
- Session data persists across browser sessions
- Vulnerable to XSS attacks
- Data accessible to browser extensions

**Recommendation:**  
- Use sessionStorage instead of localStorage for session data
- Implement HttpOnly cookies for sensitive tokens
- Clear storage on logout

---

### üü° MEDIUM-003: Cookie-Based Session Without Secure Flags

**File:** `SignalRNotification.js` (Lines 134-144)  
**CVSS Score:** 4.3 (Medium)

**Description:**  
Cookies are set and deleted without specifying security attributes like Secure, HttpOnly, or SameSite.

**Affected Code:**
```javascript
document.cookie = name + "=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;";
```

**Impact:**  
- Cookies may be transmitted over HTTP
- Cookies accessible to JavaScript (XSS risk)
- Cross-site request forgery (CSRF) possible

**Recommendation:**  
- Set Secure flag for HTTPS-only transmission
- Set HttpOnly flag to prevent JavaScript access
- Set SameSite=Strict or SameSite=Lax for CSRF protection

---

## Recommendations Summary

### Immediate Actions (Critical)
1. **Remove hardcoded cryptographic keys** from client-side code
2. **Implement server-side encryption** for sensitive data
3. **Increase PBKDF2 iterations** to minimum 100,000
4. **Upgrade cryptographic libraries** to current versions

### Short-Term Actions (High)
5. **Review and secure ViewState** configuration
6. **Replace XOR obfuscation** with proper session tokens
7. **Update CryptoJS** to version 4.x or use Web Crypto API
8. **Audit exposed endpoints** and minimize disclosure

### Medium-Term Actions (Medium)
9. **Implement proper cookie security** flags
10. **Replace localStorage** with secure alternatives
11. **Remove browser restriction scripts**
12. **Conduct full penetration testing**

---

## Compliance Implications

| Standard | Status | Notes |
|----------|--------|-------|
| PCI-DSS | ‚ùå Non-Compliant | Hardcoded keys, weak crypto |
| SOC 2 | ‚ùå Non-Compliant | Inadequate access controls |
| OWASP Top 10 | ‚ùå Violations | A02:2021-Cryptographic Failures, A05:2021-Security Misconfiguration |
| GDPR | ‚ö†Ô∏è Risk | Personal data encryption inadequate |

---

## Appendix: Files Reviewed

| File | Size | Type |
|------|------|------|
| QwikCilver Electronic Gift Card Management System.html | 27.7 KB | Main Login Page |
| aes.js | 17.9 KB | AES Encryption Library |
| pbkdf2.js | 7.3 KB | PBKDF2 Key Derivation |
| SignalRNotification.js | 5.6 KB | Session Management |
| jquery.min.js | 87.5 KB | jQuery 3.7.1 |
| signalr.min.js | 53.6 KB | SignalR Client |

---

*This report is confidential and intended for internal security review purposes only.*
